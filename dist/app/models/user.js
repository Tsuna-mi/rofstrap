var SALT_WORK_FACTOR,User,bcrypt,mongoose,userSchema;mongoose=require("mongoose"),bcrypt=require("bcrypt"),SALT_WORK_FACTOR=10,userSchema=mongoose.Schema({username:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0}}),userSchema.pre("save",function(e){var r;return r=this,r.isModified("password")?bcrypt.genSalt(SALT_WORK_FACTOR,function(o,s){return o?e(o):bcrypt.hash(r.password,s,function(o,s){return o?e(o):(r.password=s,e())})}):e()}),userSchema.methods.comparePassword=function(e,r){return bcrypt.compare(e,this.password,function(e,o){return e?r(e):r(null,o)})},module.exports=User=mongoose.model("User",userSchema);