var LocalStrategy,User,express,passport;passport=require("passport"),express=require("express"),LocalStrategy=require("passport-local").Strategy,User=require("./../models/user"),module.exports=function(){return passport.serializeUser(function(r,e){return e(null,r.id)}),passport.deserializeUser(function(r,e){return User.findById(r,function(r,s){return e(r,s)})}),passport.use(new LocalStrategy(function(r,e,s){return User.findOne({username:r},function(r,n){return r?s(r):n?n.comparePassword(e,function(r,e){return r?s(r):e?s(null,n):s(null,!1,{message:"Incorrect password."})}):s(null,!1,{message:"Incorrect username."})})}))};